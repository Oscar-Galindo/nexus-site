---
/**
 * Homepage
 * Renders the home page from Contentful modular page builder
 */

import BaseLayout from '@/layouts/BaseLayout.astro';
import Navigation from '@/components/global/Navigation.astro';
import SiteFooter from '@/components/global/SiteFooter.astro';
import SectionRenderer from '@/components/SectionRenderer.astro';
import { getPageBySlug } from '@/lib/contentful';

// Fetch home page from Contentful
const page = await getPageBySlug('/');

// Default content if Contentful is not configured or page not found
const defaultTitle = 'Online Nexus Marketing';
const footerContent = {
  logoUrl: 'https://res.cloudinary.com/dhs9d8tou/image/upload/v1769829242/onmlogo_bhcbxa.png',
  tagline: 'Hand it off. It\'s handled.',
};

const title = page?.title || defaultTitle;
---

<BaseLayout title={title}>
  
  <Navigation currentPath="/" />

  {page ? (
    <>
      {/* Render Hero Section first if present */}
      {page.heroSection && (
        <SectionRenderer section={page.heroSection} index={0} />
      )}
      {/* Then render other sections */}
      {page.sections.map((section, index) => (
        <SectionRenderer section={section} index={index + 1} />
      ))}
    </>
  ) : (
    <!-- Fallback content if no page or sections -->
    <section class="w-full pt-40 pb-24 md:pt-52 md:pb-32 px-6 md:px-12 bg-white text-black">
      <div class="max-w-5xl mx-auto">
        <h1 class="text-6xl md:text-8xl font-semibold tracking-tighter leading-[0.9] text-black mb-10">
          Hand It Off.<br/>It's Handled.
        </h1>
        <div class="max-w-2xl">
          <p class="text-xl md:text-2xl text-neutral-600 font-body font-light leading-relaxed mb-10">
            Your website, email, CRM, and content — handled by one person who owns it all.
          </p>
          <a
            href="https://calendly.com/onlinenexusmarketing/strategy-meeting"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center px-8 py-4 bg-black text-white text-base md:text-lg font-medium rounded-lg hover:bg-neutral-800 transition-all duration-300 group"
          >
            Book a Call
            <span class="ml-2 group-hover:translate-x-1 transition-transform">→</span>
          </a>
        </div>
      </div>
    </section>
  )}

  <SiteFooter
    logoUrl={footerContent.logoUrl}
    tagline={footerContent.tagline}
  />
</BaseLayout>
